# IPBlockerTools

Набор инструментов для анализа лог-файлов и блокировки подозрительных IP-адресов на основе их активности.
Включает в себя вывод whois и данных из ABUSEIPDB.

## Содержание

1. `state_ip.py` - скрипт для анализа лог-файлов и получения списка IP-адресов с количеством дублей.
2. `block_ips.sh` - скрипт для блокировки IP-адресов из списка, сгенерированного `state_ip.py`, с использованием `iptables`.

## Использование

- Склонируйте репозиторий
- Переименуйте `sample.env` и `sample.config.json` в `.env` и `config.json` соответственно.
- Внесите в файле .env данные о API KEY ABUSEIPDB.

### state_ip.py

Скрипт анализирует лог-файлы веб-сервера и генерирует список IP-адресов с количеством дублей на основе заданного временного интервала.

Запустите скрипт:

```bash
python state_ip.py
```

Скрипт сгенерирует файл blocked_ips.txt, содержащий список IP-адресов и количество дублей. После этого будет автоматически запущен скрипт block_ips.sh

### block_ips.sh

Скрипт читает список IP-адресов из файла blocked_ips.txt, сгенерированного скриптом state_ip.py, и блокирует их с использованием iptables выводя перед этим whois по ип адресу и данные из ABUSEIPDB. Перед блокировкой каждого ип скрипт запросит подтверждение.

Запустите скрипт:

```./block_ips.sh```

Скрипт запросит подтверждение на блокировку каждого IP-адреса из списка. Выберите `y` для блокировки или `n` для пропуска.

![image](https://user-images.githubusercontent.com/1340282/230797133-f1d0cecd-ec91-4a43-bbb1-4fc6eee76689.png)


## Зависимости

- Python 3
- iptables
